cat << 'EOF' > logic.js
const sectors = {
    n9_half: [16, 33, 21, 6, 18, 31, 19, 8, 12, 29, 25, 10, 27, 0, 1, 13, 36, 24, 3]
};

const getMasterStrategy = (history, timeHistory, bankroll = 500) => {
    if (history.length < 5) return { command: 'SYNCING...', confidence: 0, color: '#888', recommendedBet: 'WAIT' };

    const n = history.length;
    const p = 19 / 37; 
    const observed = history.filter(num => sectors.n9_half.includes(num)).length;
    const expected = n * p;
    const stdDev = Math.sqrt(n * p * (1 - p));
    const zScore = (observed - expected) / stdDev;

    const lastTime = timeHistory[0] || 0;
    const avgTime = timeHistory.reduce((a, b) => a + b, 0) / (timeHistory.length || 1);
    const rhythmDiff = Math.abs(lastTime - avgTime);

    let edge = 0;
    if (zScore < -0.8) edge += 0.05; 
    if (rhythmDiff < 0.5) edge += 0.08; 

    const winProb = p + edge;
    const kellyFraction = (2 * winProb - 1) / 1; 
    const totalBet = Math.max(0, Math.floor(bankroll * kellyFraction * 0.15)); 
    const betPerNumber = Math.floor(totalBet / 19) || 1;

    let command = 'SCANNING';
    let color = '#ffcc00';
    if (zScore < -1.0 && rhythmDiff < 0.5) {
        command = 'STRIKE: HEAVY HALF';
        color = '#00ff66';
    } else if (rhythmDiff > 0.8) {
        command = 'ERRATIC: NO BET';
        color = '#ff4444';
    }

    return {
        command, color,
        confidence: Math.min((winProb * 100), 99).toFixed(0),
        zScore: zScore.toFixed(2),
        recommendedBet: `$${betPerNumber} / unit`,
        totalRisk: `$${betPerNumber * 19}`,
        rhythm: rhythmDiff < 0.5 ? 'STABLE' : 'DRIFT'
    };
};
module.exports = { getMasterStrategy };
EOF
